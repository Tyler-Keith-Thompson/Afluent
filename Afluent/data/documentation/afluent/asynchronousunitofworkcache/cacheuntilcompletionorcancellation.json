{"topicSections":[{"title":"Instance Methods","identifiers":["doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache\/CacheUntilCompletionOrCancellation\/handle(unitOfWork:keyedBy:storedIn:)"],"anchor":"Instance-Methods","generated":true},{"title":"Default Implementations","identifiers":["doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache\/CacheUntilCompletionOrCancellation\/AUOWCacheStrategy-Implementations"],"anchor":"Default-Implementations","generated":true}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/afluent\/asynchronousunitofworkcache\/cacheuntilcompletionorcancellation"]}],"metadata":{"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CacheUntilCompletionOrCancellation","kind":"identifier"}],"externalID":"s:7Afluent27AsynchronousUnitOfWorkCacheC0F29UntilCompletionOrCancellationV","remoteSource":{"fileName":"AUOWCache+CacheUntilCompletionOrCancellation.swift","url":"https:\/\/github.com\/Tyler-Keith-Thompson\/Afluent\/blob\/main\/Sources\/Afluent\/AUOWCacheStrategies\/AUOWCache+CacheUntilCompletionOrCancellation.swift#L44"},"modules":[{"name":"Afluent"}],"symbolKind":"struct","navigatorTitle":[{"text":"CacheUntilCompletionOrCancellation","kind":"identifier"}],"title":"AsynchronousUnitOfWorkCache.CacheUntilCompletionOrCancellation","roleHeading":"Structure","role":"symbol","extendedModule":"Afluent"},"schemaVersion":{"minor":3,"major":0,"patch":0},"hierarchy":{"paths":[["doc:\/\/Afluent\/documentation\/Afluent","doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache"]]},"kind":"symbol","abstract":[{"text":"A caching strategy that retains a unit of work in the cache until it completes, fails, or is cancelled.","type":"text"}],"primaryContentSections":[{"declarations":[{"platforms":["macOS"],"languages":["swift"],"tokens":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"CacheUntilCompletionOrCancellation"}]}],"kind":"declarations"},{"kind":"content","content":[{"anchor":"overview","level":2,"text":"Overview","type":"heading"},{"inlineContent":[{"text":"This strategy is useful when you want to deduplicate concurrent requests for the same unit of work, ensuring that","type":"text"},{"text":" ","type":"text"},{"text":"all consumers receive the same result, and the cached value is automatically cleared after completion or cancellation.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The cached entry is cleared on:"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"successful completion (output received)"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"error thrown"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"cancellation","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"Example","level":2,"text":"Example","type":"heading"},{"code":["let cache = AUOWCache()","","\/\/ A unit of work that produces a String after a delay","@Sendable func unitOfWork() -> some AsynchronousUnitOfWork<String> {","    DeferredTask {","        \/\/ ... expensive computation or network call ...","        return \"result\"","    }","    .shareFromCache(cache, strategy: .cacheUntilCompletionOrCancellation)","}","","\/\/ First execution stores the value in the cache","let task1 = unitOfWork().execute()","\/\/ Second execution (if started before completion) shares the cached value","let task2 = unitOfWork().execute()","","\/\/ When task1 completes, the cache entry is cleared"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"See also: ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AUOWCacheStrategy\/cacheUntilCompletionOrCancellation"}],"type":"paragraph"}]}],"relationshipsSections":[{"title":"Conforms To","identifiers":["doc:\/\/Afluent\/documentation\/Afluent\/AUOWCacheStrategy"],"type":"conformsTo","kind":"relationships"}],"sections":[],"identifier":{"url":"doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache\/CacheUntilCompletionOrCancellation","interfaceLanguage":"swift"},"references":{"doc://Afluent/documentation/Afluent/AsynchronousUnitOfWorkCache/CacheUntilCompletionOrCancellation/handle(unitOfWork:keyedBy:storedIn:)":{"role":"symbol","url":"\/documentation\/afluent\/asynchronousunitofworkcache\/cacheuntilcompletionorcancellation\/handle(unitofwork:keyedby:storedin:)","identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache\/CacheUntilCompletionOrCancellation\/handle(unitOfWork:keyedBy:storedIn:)","abstract":[],"kind":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"handle","kind":"identifier"},{"text":"<","kind":"text"},{"text":"A","kind":"genericParameter"},{"text":">(","kind":"text"},{"text":"unitOfWork","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"A","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"keyedBy","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Int","kind":"typeIdentifier","preciseIdentifier":"s:Si"},{"text":", ","kind":"text"},{"text":"storedIn","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"AUOWCache","kind":"typeIdentifier","preciseIdentifier":"s:7Afluent9AUOWCachea"},{"text":") -> ","kind":"text"},{"text":"AnyAsynchronousUnitOfWork","kind":"typeIdentifier","preciseIdentifier":"s:7Afluent25AnyAsynchronousUnitOfWorkV"},{"text":"<","kind":"text"},{"text":"A","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"Success","kind":"typeIdentifier","preciseIdentifier":"s:7Afluent22AsynchronousUnitOfWorkP7SuccessQa"},{"text":">","kind":"text"}],"type":"topic","title":"handle(unitOfWork:keyedBy:storedIn:)"},"doc://Afluent/documentation/Afluent/AsynchronousUnitOfWorkCache/CacheUntilCompletionOrCancellation":{"title":"AsynchronousUnitOfWorkCache.CacheUntilCompletionOrCancellation","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CacheUntilCompletionOrCancellation","kind":"identifier"}],"identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache\/CacheUntilCompletionOrCancellation","navigatorTitle":[{"text":"CacheUntilCompletionOrCancellation","kind":"identifier"}],"role":"symbol","type":"topic","kind":"symbol","abstract":[{"text":"A caching strategy that retains a unit of work in the cache until it completes, fails, or is cancelled.","type":"text"}],"url":"\/documentation\/afluent\/asynchronousunitofworkcache\/cacheuntilcompletionorcancellation"},"doc://Afluent/documentation/Afluent/AsynchronousUnitOfWorkCache":{"kind":"symbol","type":"topic","navigatorTitle":[{"text":"AsynchronousUnitOfWorkCache","kind":"identifier"}],"url":"\/documentation\/afluent\/asynchronousunitofworkcache","abstract":[{"type":"text","text":"A thread-safe cache for storing and sharing asynchronous units of work."}],"title":"AsynchronousUnitOfWorkCache","role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AsynchronousUnitOfWorkCache","kind":"identifier"}],"identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache"},"doc://Afluent/documentation/Afluent/AUOWCache":{"abstract":[],"role":"symbol","title":"AUOWCache","kind":"symbol","navigatorTitle":[{"text":"AUOWCache","kind":"identifier"}],"identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AUOWCache","url":"\/documentation\/afluent\/auowcache","type":"topic","fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AUOWCache","kind":"identifier"}]},"doc://Afluent/documentation/Afluent":{"abstract":[],"url":"\/documentation\/afluent","role":"collection","type":"topic","kind":"symbol","title":"Afluent","identifier":"doc:\/\/Afluent\/documentation\/Afluent"},"doc://Afluent/documentation/Afluent/AUOWCacheStrategy/cacheUntilCompletionOrCancellation":{"identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AUOWCacheStrategy\/cacheUntilCompletionOrCancellation","type":"topic","fragments":[{"text":"static","kind":"keyword"},{"text":" ","kind":"text"},{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"cacheUntilCompletionOrCancellation","kind":"identifier"},{"text":": ","kind":"text"},{"text":"AsynchronousUnitOfWorkCache","preciseIdentifier":"s:7Afluent27AsynchronousUnitOfWorkCacheC","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"CacheUntilCompletionOrCancellation","preciseIdentifier":"s:7Afluent27AsynchronousUnitOfWorkCacheC0F29UntilCompletionOrCancellationV","kind":"typeIdentifier"}],"kind":"symbol","url":"\/documentation\/afluent\/auowcachestrategy\/cacheuntilcompletionorcancellation","conformance":{"constraints":[{"code":"Self","type":"codeVoice"},{"text":" is ","type":"text"},{"code":"AsynchronousUnitOfWorkCache.CacheUntilCompletionOrCancellation","type":"codeVoice"},{"text":".","type":"text"}],"availabilityPrefix":[{"text":"Available when","type":"text"}],"conformancePrefix":[{"text":"Conforms when","type":"text"}]},"title":"cacheUntilCompletionOrCancellation","abstract":[{"type":"text","text":"Returns the "},{"code":".cacheUntilCompletionOrCancellation","type":"codeVoice"},{"type":"text","text":" strategy."}],"role":"symbol"},"doc://Afluent/documentation/Afluent/AsynchronousUnitOfWorkCache/CacheUntilCompletionOrCancellation/AUOWCacheStrategy-Implementations":{"identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AsynchronousUnitOfWorkCache\/CacheUntilCompletionOrCancellation\/AUOWCacheStrategy-Implementations","abstract":[],"type":"topic","role":"collectionGroup","kind":"article","url":"\/documentation\/afluent\/asynchronousunitofworkcache\/cacheuntilcompletionorcancellation\/auowcachestrategy-implementations","title":"AUOWCacheStrategy Implementations"},"doc://Afluent/documentation/Afluent/AUOWCacheStrategy":{"abstract":[{"type":"text","text":"Represents a cache strategy for use with "},{"isActive":true,"type":"reference","identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AUOWCache"},{"type":"text","text":"."}],"url":"\/documentation\/afluent\/auowcachestrategy","kind":"symbol","identifier":"doc:\/\/Afluent\/documentation\/Afluent\/AUOWCacheStrategy","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AUOWCacheStrategy","kind":"identifier"}],"navigatorTitle":[{"text":"AUOWCacheStrategy","kind":"identifier"}],"type":"topic","role":"symbol","title":"AUOWCacheStrategy"}}}